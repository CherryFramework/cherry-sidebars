!function(e){"use strict";var r={submitButton:null,spinner:null,errorMessage:null,form:null,btnNewSidebar:null,btnRemoveSidebar:null,customSidebarHolder1:null,customSidebarHolder2:null,ajaxRequest:null,newSidebarData:{action:"add_new_custom_sidebar",security:window.cherryFramework.ajax_nonce_new_sidebar,formdata:{}},removeSidebarData:{action:"remove_custom_sidebar",id:"",security:window.cherryFramework.ajax_nonce_remove_sidebar},init:function(){var r=this;r.form=e("#cherry-sidebars-form"),r.submitButton=e("#sidebar-manager-submit",r.form),r.spinner=e(".spinner-wordpress-type-1",r.form),r.errorMessage=e("#cherry-error-message",r.form),r.customSidebarHolder1=e("#cherry-sidebars-holder .sidebars-column-1"),r.customSidebarHolder2=e("#cherry-sidebars-holder .sidebars-column-2"),r.btnNewSidebar=e(".btn-create-sidebar.thickbox"),r.btnRemoveSidebar=e(".cherry-delete-sidebar-manager"),r.submitButton.on("click",r.submitByttonHandler),r.btnNewSidebar.on("click",r.openThickBox),r.btnRemoveSidebar.on("click",r.removeCustomSidebar),e.ajaxSetup({type:"GET",url:window.ajaxurl,cache:!1})},openThickBox:function(){e('input[type="text"]',r.form).removeClass("error-invalid")},submitByttonHandler:function(){var a,i,o,t=r.form.serializeArray();for(a in t)i=t[a],o=e('input[name="'+i.name+'"]',r.form),!i.value&&o.hasClass("required")?o.addClass("error-invalid"):o.removeClass("error-invalid");return e(".error-invalid",r.form)[0]||(r.newSidebarData.formdata=t,r.aJaxRequestNewSitebar()),!1},aJaxRequestNewSitebar:function(){r.ajaxRequest=e.ajax({data:r.newSidebarData,beforeSend:function(){r.submitButton.attr({disabled:!0}),r.spinner.css({display:"block"}),r.ajaxRequest&&r.ajaxRequest.abort()},success:function(a){var i=e(".widgets-holder-wrap",r.customSidebarHolder1).length,o=e(".widgets-holder-wrap",r.customSidebarHolder2).length,t=e(a);o>=i?r.customSidebarHolder1.append(t):r.customSidebarHolder2.append(t),e(".cherry-delete-sidebar-manager",t).on("click",r.removeCustomSidebar),e('input[type="text"]',r.form).val(""),e(".tb-close-icon").trigger("click"),e("#widgets-right .sidebar-name").off("click"),e("#widgets-left .sidebar-name").off("click"),e("body").off("click.widgets-toggle"),e(".widgets-chooser").off("click.widgets-chooser").off("keyup.widgets-chooser"),e("#available-widgets .widget .widget-title").off("click.widgets-chooser"),e(".widgets-chooser-sidebars > li").remove(),window.wpWidgets&&(window.wpWidgets.hoveredSidebar=null,window.wpWidgets.init())},complete:function(){r.spinner.delay(200).css({display:"none"}),r.submitButton.attr({disabled:!1})},error:function(){r.errorMessage.css({display:"block"}).delay(3e3).fadeOut(800,0)}})},removeCustomSidebar:function(){var a=e(this).parents(".cherry-widgets-holder-wrap");r.removeSidebarData.id=e(".widgets-sortables",a).attr("id"),r.requestRemoveSidebar(a)},requestRemoveSidebar:function(a){r.ajaxRequest=e.ajax({data:r.removeSidebarData,beforeSend:function(){e(".cherry-spinner-wordpress",a).css({display:"block"})},success:function(){a.remove()}})}};e(document).ready(function(){r.init(),e("body:not(.widgets_access) .sidebar-manager-name").on("click",function(){var r=e(this);e("~ .sidebars-holder",r).toggleClass("closed"),e(".sidebar-name-arrow",r).toggleClass("closed-arrow")})})}(jQuery);
