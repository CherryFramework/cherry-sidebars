!function(e){"use strict";var r={submitButton:null,spinner:null,form:null,btnNewSidebar:null,btnRemoveSidebar:null,customSidebarHolder1:null,customSidebarHolder2:null,ajaxRequest:null,newSidebarData:{action:"add_new_custom_sidebar",security:window.cherryFramework.ajax_nonce_new_sidebar,formdata:{}},removeSidebarData:{action:"remove_custom_sidebar",id:"",security:window.cherryFramework.ajax_nonce_remove_sidebar},init:function(){var r=this;r.form=e("#cherry-sidebars-form"),r.submitButton=e("#sidebar-manager-submit",r.form),r.spinner=e(".spinner-wordpress-type-1",r.form),r.customSidebarHolder1=e("#cherry-sidebars-holder .sidebars-column-1"),r.customSidebarHolder2=e("#cherry-sidebars-holder .sidebars-column-2"),r.btnNewSidebar=e(".btn-create-sidebar.thickbox"),r.btnRemoveSidebar=e(".cherry-delete-sidebar-manager"),r.submitButton.on("click",r.submitByttonHandler),r.btnNewSidebar.on("click",r.openThickBox),r.btnRemoveSidebar.on("click",r.removeCustomSidebar),e.ajaxSetup({type:"GET",url:window.ajaxurl,cache:!1})},openThickBox:function(){e('input[type="text"]',r.form).removeClass("error-invalid")},submitByttonHandler:function(){var t,a,i,o=r.form.serializeArray();for(t in o)a=o[t],i=e('input[name="'+a.name+'"]',r.form),a.value?i.removeClass("error-invalid"):i.addClass("error-invalid");return e(".error-invalid",r.form)[0]||(r.newSidebarData.formdata=o,r.aJaxRequestNewSitebar()),!1},reInitWidgets:function(){e("#widgets-right .sidebar-name").off("click"),e("#widgets-left .sidebar-name").off("click"),e("body").off("click.widgets-toggle"),e(".widgets-chooser").off("click.widgets-chooser").off("keyup.widgets-chooser"),e("#available-widgets .widget .widget-title").off("click.widgets-chooser"),e(".widgets-chooser-sidebars > li").remove(),window.wpWidgets&&(window.wpWidgets.hoveredSidebar=null,window.wpWidgets.init())},aJaxRequestNewSitebar:function(){r.ajaxRequest=e.ajax({data:r.newSidebarData,beforeSend:function(){r.disableButton(r.submitButton),r.ajaxRequest&&r.ajaxRequest.abort()},success:function(t){var a=e(".widgets-holder-wrap",r.customSidebarHolder1).length,i=e(".widgets-holder-wrap",r.customSidebarHolder2).length,o=e(t);i>=a?r.customSidebarHolder1.append(o):r.customSidebarHolder2.append(o),e(".cherry-delete-sidebar-manager",o).on("click",r.removeCustomSidebar),e('input[type="text"]',r.form).val(""),e(".tb-close-icon").trigger("click"),r.reInitWidgets()},complete:function(){r.enableButton(r.submitButton)}})},removeCustomSidebar:function(){var t=e(this).parents(".cherry-widgets-holder-wrap");r.removeSidebarData.id=e(".widgets-sortables",t).attr("id"),r.requestRemoveSidebar(t)},requestRemoveSidebar:function(t){r.ajaxRequest=e.ajax({data:r.removeSidebarData,beforeSend:function(){e(".cherry-loader-wrapper",t).addClass("show")},success:function(){t.remove(),r.reInitWidgets()}})},disableButton:function(r){e(r).attr("disabled","disabled")},enableButton:function(r){e(r).removeAttr("disabled")}};e(document).ready(function(){r.init(),e("body:not(.widgets_access) .sidebar-manager-name").on("click",function(){var r=e(this);e("~ .sidebars-holder",r).toggleClass("closed"),e(".sidebar-name-arrow",r).toggleClass("closed-arrow")})})}(jQuery);